<!DOCTYPE html>
<html lang="en-US">

    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        
        <meta name="description" content="Practical Cybersecurity Blog">
        
        <meta name="keywords" content="cybersecurity, infosec, bug-bounty, bugbounty, SOC, CTI, VM, Pentest, Cyber Defense">

        <title>
              Cyber Frogy - (SIEM) The Data Normalization Problem Nobody Talks About 
        </title>

        <meta name="generator" content="Hugo 0.156.0">

        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
        

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
            crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/main.css">
        <link rel="stylesheet" href="http://localhost:1313/css/custom.css">

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <meta name="theme-color" content="#ffffff"></head>

    <body lang="en-US" class="is-page">
        <div class="container my-auto">



<div class="site-nav">
  <div class="site-nav__inner">
    <a class="site-brand" href="/">
      <span class="site-brand__mark"></span>
      <span class="site-brand__text">Cyber Frogy</span>
    </a>
    
    <nav class="site-menu d-none d-md-flex">
      
      <a class="site-menu__link" href="/">Home</a>
      
      <a class="site-menu__link" href="/whoami">Whoami</a>
      
      <a class="site-menu__link" href="/posts">Blog</a>
      
      <a class="site-menu__link" href="/mindmaps">Mindmaps</a>
      
      <a class="site-menu__link" href="/threat-actor-db">Threat-Actor DB</a>
      
      <a class="site-menu__link" href="/github">GitHub</a>
      
      <a class="site-menu__link" href="/checklists">Checklists</a>
      
      <a class="site-menu__link" href="/kickstartcareer">Kickstart Career</a>
      
      <a class="site-menu__link" href="/disclaimer">Disclaimer</a>
      
    </nav>
    
    <div class="site-nav__actions">
      
      <button class="navbar-toggler site-menu__toggle d-md-none" type="button" data-bs-toggle="collapse"
        data-bs-target="#site-menu-drawer" aria-controls="site-menu-drawer" aria-expanded="false"
        aria-label="Toggle navigation">
        <i class="fa-solid fa-bars"></i>
      </button>
      
    </div>
  </div>
  
  <div class="collapse site-menu__drawer d-md-none" id="site-menu-drawer">
    <nav class="d-flex flex-column gap-2">
      
      <a class="site-menu__link" href="/">Home</a>
      
      <a class="site-menu__link" href="/whoami">Whoami</a>
      
      <a class="site-menu__link" href="/posts">Blog</a>
      
      <a class="site-menu__link" href="/mindmaps">Mindmaps</a>
      
      <a class="site-menu__link" href="/threat-actor-db">Threat-Actor DB</a>
      
      <a class="site-menu__link" href="/github">GitHub</a>
      
      <a class="site-menu__link" href="/checklists">Checklists</a>
      
      <a class="site-menu__link" href="/kickstartcareer">Kickstart Career</a>
      
      <a class="site-menu__link" href="/disclaimer">Disclaimer</a>
      
    </nav>
  </div>
  
</div>



<main class="page-shell">
  <article class="page-article">
    <header class="page-article__header">
      <h1 class="page-article__title">(SIEM) The Data Normalization Problem Nobody Talks About</h1>
    </header>

    <section id="category-pane" class="page-article__meta meta-block">
      
      <div class="meta-row">
        <p class="meta meta--label">
           PUBLISHED ON FEB 23, 2026
          
          / 21 MIN READ
          
        </p>
      </div>
      
    </section>

    <section id="content-pane" class="page-article__content">
      <div class="content">
        
        <nav id="TableOfContents">
  <ul>
    <li><a href="#01---the-problem-space-why-security-data-is-still-a-mess-in-2026">01 - The Problem Space: Why Security Data Is Still a Mess in 2026</a></li>
    <li><a href="#02---the-standard-ocsf-the-common-language-for-security-events">02 - The Standard: OCSF, the Common Language for Security Events</a></li>
    <li><a href="#03---the-tool-what-is-fleak-and-what-does-the-ocsf-mapper-actually-do">03 - The Tool: What is Fleak, and What Does the OCSF Mapper Actually Do?</a></li>
    <li><a href="#04---architecture-how-it-works-end-to-end">04 - Architecture: How It Works End to End</a></li>
    <li><a href="#05---technical-deep-dive-what-the-ai-is-actually-doing">05 - Technical Deep Dive: What the AI Is Actually Doing</a></li>
    <li><a href="#06---hands-on-sample-log-labs">06 - Hands-On Sample Log Labs</a>
      <ul>
        <li><a href="#example-1---aws-cloudtrail-suspicious-assumerole-event">Example 1 - AWS CloudTrail: Suspicious AssumeRole Event</a></li>
        <li><a href="#example-2---windows-security-event-log-password-spray-event-id-4625">Example 2 - Windows Security Event Log: Password Spray (Event ID 4625)</a></li>
        <li><a href="#example-3---palo-alto-ngfw-log4shell-threat-alert">Example 3 - Palo Alto NGFW: Log4Shell Threat Alert</a></li>
        <li><a href="#example-4---zeek-bro-network-sensor-connlog-with-c2-pattern">Example 4 - Zeek (Bro) Network Sensor: conn.log with C2 Pattern</a></li>
        <li><a href="#example-5---okta-system-log-impossible-travel">Example 5 - Okta System Log: Impossible Travel</a></li>
      </ul>
    </li>
    <li><a href="#07---zephflow-the-open-source-execution-engine">07 - ZephFlow: The Open-Source Execution Engine</a></li>
    <li><a href="#08---the-honest-verdict-360-degree-evaluation">08 - The Honest Verdict: 360-Degree Evaluation</a>
      <ul>
        <li><a href="#what-works-well">What Works Well</a></li>
        <li><a href="#what-needs-work">What Needs Work</a></li>
        <li><a href="#feature-comparison-against-alternatives">Feature Comparison Against Alternatives</a></li>
      </ul>
    </li>
    <li><a href="#the-broader-context-why-this-matters-for-ai-soc">The Broader Context: Why This Matters for AI SOC</a></li>
    <li><a href="#final-thoughts">Final Thoughts</a></li>
  </ul>
</nav>
        
        <p>If you have spent any meaningful time inside a Security Operations Centre - or have been responsible for one - you will know this feeling intimately. Alert fires. You open your SIEM. Then your EDR console. Then those cloud logs sitting in their own separate universe. Somewhere in the middle of all this, you are manually translating between <code>user_name</code>, <code>userid</code>, and <code>account_identifier</code> - three fields that mean exactly the same thing, from three different vendors, in three different formats.</p>
<p>This is not a new problem. It has existed since the first security tool was ever sold. But what is interesting now - and frankly what makes this a timely conversation - is that AI-driven security workflows are being built on top of <strong>this exact broken foundation</strong>. If the data going into your detection pipeline is messy, vendor-fragmented, and un-normalised, no amount of AI on top will save you. The garbage-in, garbage-out principle is ruthlessly unforgiving.</p>
<p>So when I came across <a href="https://app.ocsf.fleak.ai/">Fleak&rsquo;s OCSF Log Mapper</a>, I decided to go in properly - not just a five-minute click-through, but a real, working, end-to-end examination. What follows is that account - complete with <strong>six hands-on sample log labs</strong> you can paste directly into the tool yourself.</p>
<hr>
<h2 id="01---the-problem-space-why-security-data-is-still-a-mess-in-2026">01 - The Problem Space: Why Security Data Is Still a Mess in 2026</h2>
<blockquote>
<p><strong>For Executives:</strong> Every security tool your organisation buys speaks its own data language. Before AI or automation can work reliably, someone has to translate between all of them. That translation work is costing your engineering team weeks, sometimes months, of effort per year - and it is almost entirely invisible to leadership.</p>
</blockquote>
<p>Let us be concrete about the scale of this problem. A mid-size enterprise running a modern security stack will typically have a SIEM like Splunk, Microsoft Sentinel, or Google Chronicle; one or more EDR platforms (CrowdStrike, SentinelOne, Microsoft Defender); cloud provider logs from AWS CloudTrail, Azure Activity Logs, and GCP Audit Logs; network device logs from Cisco ASA, Palo Alto, or Fortinet firewalls; identity logs from Okta, Azure AD, or Ping Identity; and possibly application-layer logs, container logs, and Kubernetes audit trails on top of all that.</p>
<p>The following diagram shows the core problem. The same authentication failure event, fragmented across six common enterprise security tools, each naming fields differently - all pointing to one overwhelmed analyst who needs to produce a single detection rule:</p>
<center><img src="/images/fleak1.png" width="850"/></center></br>
<p>The following is the same event - a <strong>failed authentication</strong> - rendered across three common vendors. All three mean exactly the same thing. None of them look alike:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// Okta - Identity Provider
</span></span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;actor&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;alternateId&#34;</span>: <span style="color:#e6db74">&#34;john.doe@acme.com&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventType&#34;</span>: <span style="color:#e6db74">&#34;user.authentication.sso&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;outcome&#34;</span>: { <span style="color:#f92672">&#34;result&#34;</span>: <span style="color:#e6db74">&#34;FAILURE&#34;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;published&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T08:23:11.000Z&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// Cisco ASA - Network Firewall
</span></span><span style="display:flex;"><span>Feb 18 08:23:11 firewall : %ASA-4-106023: Deny tcp src outside:203.0.113.45/54321
</span></span><span style="display:flex;"><span>  dst inside:10.0.0.50/443 by access-group &#34;outside_in&#34; [0x12345678, 0x0]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// CrowdStrike EDR - Endpoint
</span></span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;UserName&#34;</span>: <span style="color:#e6db74">&#34;ACME\\john.doe&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;LogonType&#34;</span>: <span style="color:#e6db74">&#34;INTERACTIVE&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;EventType&#34;</span>: <span style="color:#e6db74">&#34;AuthenticationEvent&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AuthFailedReason&#34;</span>: <span style="color:#e6db74">&#34;WRONG_PASSWORD&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>All three are the same class of event. But without a normalisation layer, your detection rule written for Okta will not fire on the Cisco or CrowdStrike data. Your AI analyst will query different indices. Your SIEM dashboards will show incomplete counts. Your incident response team will miss correlated signals.</p>
<blockquote>
<p><strong>For Security Operations:</strong> This is why your threat hunters are spending 40–60% of their time writing and maintaining field mappings, parser logic, and data transformation scripts. It does not show up on executive dashboards. But without it, your entire detection capability is sitting on sand.</p>
</blockquote>
<p>The security industry has known about this problem for years. The answer that has emerged - and gained real industry momentum - is the <strong>Open Cybersecurity Schema Framework (OCSF)</strong>.</p>
<hr>
<h2 id="02---the-standard-ocsf-the-common-language-for-security-events">02 - The Standard: OCSF, the Common Language for Security Events</h2>
<blockquote>
<p><strong>For Executives:</strong> OCSF is an industry-backed open standard - think of it as a universal translator for security log data. Born from a collaboration between AWS, Splunk, CrowdStrike, IBM, and 15 other major vendors, the goal is simple: if every tool speaks OCSF, detection rules work across all of them. One rule, every source.</p>
</blockquote>
<p>OCSF was open-sourced in August 2022 and has been gaining adoption at impressive pace. The following diagram shows the full taxonomy - eight top-level categories, each containing multiple event classes, all sharing a common field dictionary:</p>
<p>The below is the schema heirachy example fo the authentication event:</p>
<center><img src="/images/fleak2.png" width="1450"/></center></br>
<p>The key insight is in the leaf nodes. Every authentication event whether from Active Directory, Okta, or AWS IAM, MUST uses the same field names:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>user.name       → who did the thing
</span></span><span style="display:flex;"><span>activity_id     → what did they do  (1=Logon, 2=Logout, ...)
</span></span><span style="display:flex;"><span>status_id       → how did it go     (1=Success, 2=Failure)
</span></span><span style="display:flex;"><span>src_endpoint    → where from
</span></span><span style="display:flex;"><span>auth_protocol   → how they authenticated
</span></span></code></pre></div><p>A comprehensive OCSF implementation typically takes two to four months of engineering time. The OCSF schema browser at <a href="https://schema.ocsf.io">schema.ocsf.io</a> exposes over 80 event classes with hundreds of fields each. Getting it right requires deep familiarity with both the OCSF taxonomy and the source log formats. This is precisely where Fleak&rsquo;s tooling earns its place.</p>
<blockquote>
<p><em>&ldquo;The standard was always good. The bottleneck was never understanding the why - it was surviving the how.&rdquo;</em></p>
</blockquote>
<hr>
<h2 id="03---the-tool-what-is-fleak-and-what-does-the-ocsf-mapper-actually-do">03 - The Tool: What is Fleak, and What Does the OCSF Mapper Actually Do?</h2>
<p>Fleak is a data workflow and transformation platform with a specific focus on security data engineering. Their product portfolio includes a broader data workflow builder and an execution engine called ZephFlow - but the piece we are examining here is their free community tool: the <a href="https://app.ocsf.fleak.ai/">OCSF Log Mapper</a>.</p>
<p>The pitch is clean: you bring your raw, vendor-specific logs, and the tool uses AI to generate OCSF-compliant mapping configurations. You do not need to be an OCSF expert. You do not need to manually look up category UIDs or stitch together transformation scripts.</p>
<blockquote>
<p><strong>For Executives:</strong> Think of the Fleak OCSF Mapper as the difference between hiring a specialist translator for each language pair, versus having a machine translation system that understands the intent and produces clean, reviewable output. One leading cybersecurity platform reportedly cut their integration onboarding from two quarters down to one week using Fleak&rsquo;s technology - with a corresponding 4x revenue lift over six months.</p>
</blockquote>
<p>The tool is available for free at <a href="https://app.ocsf.fleak.ai/">app.ocsf.fleak.ai</a>. No credit card, no enterprise negotiation required.</p>
<hr>
<h2 id="04---architecture-how-it-works-end-to-end">04 - Architecture: How It Works End to End</h2>
<p>There are two distinct components in the Fleak solution, and understanding the separation of concerns between them is essential before evaluating either.</p>
<center><img src="/images/fleak3.png" width="500"/></center></br>
<p>The <strong>OCSF Mapper</strong> is where you design and test your transformations - purely a design tool, nothing runs live. <strong>ZephFlow</strong> is the execution engine that processes your live log streams using the exported configuration files. The configurations are portable and can be deployed in your own infrastructure.</p>
<blockquote>
<p><strong>For Security Operations:</strong> The decoupling of mapping design from mapping execution is genuinely smart architecture. It means your security engineers can author and test OCSF configurations in a safe, web-based environment without ever touching your production log pipeline. This maps well to a GitOps or change management workflow.</p>
</blockquote>
<h2 id="05---technical-deep-dive-what-the-ai-is-actually-doing">05 - Technical Deep Dive: What the AI Is Actually Doing</h2>
<blockquote>
<p><strong>For Engineers:</strong> This section goes deep into the mechanics. If you are evaluating at a strategic level, jump to Section 08.</p>
</blockquote>
<p>The diagram below shows the internal decision flow of the AI when it receives a raw log and needs to produce an OCSF mapping:</p>
<center><img src="/images/fleak4.png" width="500"/></center></br>
<p>The key step is <strong>Semantic Analysis</strong> - the AI is not doing a lookup table. It is understanding the <em>intent</em> of the event. The Cisco <code>%ASA-4-106023</code> code gets resolved to <code>activity_id: 6</code> (Refuse) not because there is a hardcoded mapping for that message ID, but because the AI understands that &ldquo;deny&rdquo; in a network access control context maps to OCSF&rsquo;s Refuse activity. This is semantic translation, not just syntactic renaming.</p>
<hr>
<h2 id="06---hands-on-sample-log-labs">06 - Hands-On Sample Log Labs</h2>
<p>This is where things get practical. The following six labs each contain a complete, realistic dummy log that you can paste directly into <a href="https://app.ocsf.fleak.ai/">app.ocsf.fleak.ai</a> right now. For each lab: the raw sample, step-by-step instructions, and the expected OCSF output so you can verify the AI is working correctly.</p>
<hr>
<h3 id="example-1---aws-cloudtrail-suspicious-assumerole-event">Example 1 - AWS CloudTrail: Suspicious AssumeRole Event</h3>
<p>AssumeRole is one of the most abused APIs in AWS-based attacks. An attacker who compromises any IAM credential will typically try to assume a more privileged role. This is what that event looks like in raw CloudTrail JSON.</p>
<p><strong>Raw Sample Log</strong> - save as <code>lab1-cloudtrail.json</code> and paste into the Fleak Mapper:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventVersion&#34;</span>: <span style="color:#e6db74">&#34;1.08&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;userIdentity&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;IAMUser&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;principalId&#34;</span>: <span style="color:#e6db74">&#34;AIDAEXAMPLEID123&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;arn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;accountId&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;userName&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventTime&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T03:41:22Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventSource&#34;</span>: <span style="color:#e6db74">&#34;sts.amazonaws.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventName&#34;</span>: <span style="color:#e6db74">&#34;AssumeRole&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;awsRegion&#34;</span>: <span style="color:#e6db74">&#34;ap-south-1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;sourceIPAddress&#34;</span>: <span style="color:#e6db74">&#34;185.220.101.47&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;userAgent&#34;</span>: <span style="color:#e6db74">&#34;aws-cli/2.9.0 Python/3.11.0 Linux/5.15&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requestParameters&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;roleArn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/Admin-Role&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;roleSessionName&#34;</span>: <span style="color:#e6db74">&#34;assumed-admin&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;durationSeconds&#34;</span>: <span style="color:#ae81ff">3600</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;responseElements&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;credentials&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;sessionToken&#34;</span>: <span style="color:#e6db74">&#34;FwoGZXIvYXdzEL...&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;accessKeyId&#34;</span>: <span style="color:#e6db74">&#34;ASIAEXAMPLEKEY&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;expiration&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T04:41:22Z&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errorCode&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;requestID&#34;</span>: <span style="color:#e6db74">&#34;a3b4c5d6-e7f8-1234-abcd-ef0123456789&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventID&#34;</span>: <span style="color:#e6db74">&#34;b1c2d3e4-f5a6-7890-bcde-f01234567890&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;eventType&#34;</span>: <span style="color:#e6db74">&#34;AwsApiCall&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;managementEvent&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;recipientAccountId&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Step-by-Step Instructions for app.ocsf.fleak.ai:</strong></p>
<ol>
<li>
<p>Go to <a href="https://app.ocsf.fleak.ai/">app.ocsf.fleak.ai</a> and log in (free account).</p>
</li>
<li>
<p>Click <strong>&ldquo;New Project&rdquo;</strong> → name it <code>AWS-CloudTrail-Labs</code> → click <strong>&ldquo;Create Project&rdquo;</strong>.</p>
</li>
<li>
<p>Inside the project, click <strong>&ldquo;New Mapping&rdquo;</strong> → select JSON log (you can select any based on your requirement).</p>
</li>
</ol>
<center><img src="/images/aws-fleak-1.png" width="900"/></center></br>
<ol start="4">
<li>In the input panel, paste the entire JSON block above.</li>
</ol>
<center><img src="/images/aws-fleak-2.png" width="1200"/></center></br>
<ol start="5">
<li>Click <strong>&ldquo;Analyse &amp; Map to OCSF&rdquo;</strong>. The AI should detect this as an <strong>Identity &amp; Access Management</strong> event (class 3002 Authentication).</li>
</ol>
<center><img src="/images/aws-fleak-3.png" width="1200"/></center></br>
<ol start="6">
<li>Click on <strong>Generate Mapping</strong> and it will generate rule mapping for you which would look something like below.</li>
</ol>
<center><img src="/images/aws-fleak-4.png" width="1200"/></center></br>
<p>You can also know the rule transformation code.</p>
<center><img src="/images/aws-fleak-5.png" width="1300"/></center></br>
<ol start="7">
<li>
<p>In the Visual Editor, verify that <code>userIdentity.userName</code> is mapped to <code>actor.user.name</code>, and that <code>sourceIPAddress</code> → <code>src_endpoint.ip</code>.</p>
</li>
<li>
<p>Click <strong>&ldquo;Export or Copy paste&rdquo;</strong> to download the mapping configuration file and add it to your any repository to be used.</p>
</li>
</ol>
<p><strong>OCSF Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_name&#34;</span>: <span style="color:#e6db74">&#34;Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;actor&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;app_name&#34;</span>: <span style="color:#e6db74">&#34;aws-cli/2.9.0 Python/3.11.0 Linux/5.15&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;session&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;created_time&#34;</span>: <span style="color:#ae81ff">1771386082000</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;credential_uid&#34;</span>: <span style="color:#e6db74">&#34;ASIAEXAMPLEKEY&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;expiration_time&#34;</span>: <span style="color:#ae81ff">1771389682000</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;assumed-admin&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;account&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;AWS Account&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid_alt&#34;</span>: <span style="color:#e6db74">&#34;AIDAEXAMPLEID123&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol&#34;</span>: <span style="color:#e6db74">&#34;AWS STS&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol_id&#34;</span>: <span style="color:#ae81ff">99</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_name&#34;</span>: <span style="color:#e6db74">&#34;Identity &amp; Access Management&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_uid&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_uid&#34;</span>: <span style="color:#ae81ff">3002</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dst_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;svc_name&#34;</span>: <span style="color:#e6db74">&#34;sts.amazonaws.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;Cloud Service&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;http_request&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user_agent&#34;</span>: <span style="color:#e6db74">&#34;aws-cli/2.9.0 Python/3.11.0 Linux/5.15&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_remote&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;AssumeRole operation on sts.amazonaws.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;event_code&#34;</span>: <span style="color:#e6db74">&#34;AssumeRole&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_name&#34;</span>: <span style="color:#e6db74">&#34;sts.amazonaws.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_provider&#34;</span>: <span style="color:#e6db74">&#34;sts.amazonaws.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;logged_time&#34;</span>: <span style="color:#ae81ff">1771386082000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;original_time&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T03:41:22Z&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;AWS Security Token Service&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Amazon Web Services&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;b1c2d3e4-f5a6-7890-bcde-f01234567890&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;observables&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;session.credential_uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">19</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;ASIAEXAMPLEKEY&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.owner&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.owner.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.owner.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.owner.account.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">35</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;185.220.101.47&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.account.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">35</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;http_request.user_agent&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">16</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;aws-cli/2.9.0 Python/3.11.0 Linux/5.15&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.session.credential_uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">19</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;ASIAEXAMPLEKEY&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.account.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">35</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;service&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;sts.amazonaws.com&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;session&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;created_time&#34;</span>: <span style="color:#ae81ff">1771386082000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;credential_uid&#34;</span>: <span style="color:#e6db74">&#34;ASIAEXAMPLEKEY&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;expiration_time&#34;</span>: <span style="color:#ae81ff">1771389682000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;issuer&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/Admin-Role&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;assumed-admin&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid_alt&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/Admin-Role&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;Informational&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;src_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;185.220.101.47&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;os&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;kernel_release&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Linux&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;Linux&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;owner&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;account&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;CLI Client&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;Success&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;time&#34;</span>: <span style="color:#ae81ff">1771386082000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication: Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_uid&#34;</span>: <span style="color:#ae81ff">300201</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;unmapped&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;awsRegion&#34;</span>: <span style="color:#e6db74">&#34;ap-south-1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;eventType&#34;</span>: <span style="color:#e6db74">&#34;AwsApiCall&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;eventVersion&#34;</span>: <span style="color:#e6db74">&#34;1.08&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;managementEvent&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;recipientAccountId&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;requestID&#34;</span>: <span style="color:#e6db74">&#34;a3b4c5d6-e7f8-1234-abcd-ef0123456789&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;account&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;AWS Account&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:user/dev-pipeline&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid_alt&#34;</span>: <span style="color:#e6db74">&#34;AIDAEXAMPLEID123&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>What to Notice:</strong> The source IP <code>185.220.101.47</code> is a known Tor exit node. In the raw CloudTrail log, it is buried in <code>sourceIPAddress</code>. After OCSF normalisation, it lives in the standard <code>src_endpoint.ip</code> field - meaning your detection rule <code>src_endpoint.ip IN tor_exit_list</code> now fires on this event AND on every other log source that reports source IPs, with zero per-source customisation.</p>
<hr>
<h3 id="example-2---windows-security-event-log-password-spray-event-id-4625">Example 2 - Windows Security Event Log: Password Spray (Event ID 4625)</h3>
<p>Windows Event ID 4625 is one of the highest-volume events in any Windows environment and one of the most important. Password spray attacks generate thousands of these per minute. This is what a raw Windows Security Event looks like when exported as JSON via Winlogbeat:</p>
<p><strong>Raw Sample Log</strong> - save as <code>lab2-windows-4625.json</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;winlog&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;channel&#34;</span>: <span style="color:#e6db74">&#34;Security&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;computer_name&#34;</span>: <span style="color:#e6db74">&#34;DESKTOP-ACME-042&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;event_id&#34;</span>: <span style="color:#ae81ff">4625</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;provider_name&#34;</span>: <span style="color:#e6db74">&#34;Microsoft-Windows-Security-Auditing&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;record_id&#34;</span>: <span style="color:#ae81ff">2847391</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;time_created&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T07:55:03.412Z&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;keywords&#34;</span>: [<span style="color:#e6db74">&#34;Audit Failure&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;task&#34;</span>: <span style="color:#e6db74">&#34;Logon&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;event_data&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;SubjectUserSid&#34;</span>: <span style="color:#e6db74">&#34;S-1-0-0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;SubjectUserName&#34;</span>: <span style="color:#e6db74">&#34;-&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;TargetUserName&#34;</span>: <span style="color:#e6db74">&#34;administrator&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;TargetDomainName&#34;</span>: <span style="color:#e6db74">&#34;ACME&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;Status&#34;</span>: <span style="color:#e6db74">&#34;0xC000006D&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;FailureReason&#34;</span>: <span style="color:#e6db74">&#34;%%2313&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;SubStatus&#34;</span>: <span style="color:#e6db74">&#34;0xC000006A&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;LogonType&#34;</span>: <span style="color:#e6db74">&#34;3&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;LogonProcessName&#34;</span>: <span style="color:#e6db74">&#34;NtLmSsp&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;AuthenticationPackageName&#34;</span>: <span style="color:#e6db74">&#34;NTLM&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;WorkstationName&#34;</span>: <span style="color:#e6db74">&#34;KALI-ATTACK-01&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;IpAddress&#34;</span>: <span style="color:#e6db74">&#34;10.10.10.99&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;IpPort&#34;</span>: <span style="color:#e6db74">&#34;49200&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Step-by-Step Instructions:</strong></p>
<p>Following the same steps as listed in the above AWS topic, you will get below output.</p>
<center><img src="/images/aws-fleak-6.png" width="1300"/></center></br>
<p><strong>OCSF Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_name&#34;</span>: <span style="color:#e6db74">&#34;Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;actor&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;-&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;S-1-0-0&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol&#34;</span>: <span style="color:#e6db74">&#34;NTLM&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_name&#34;</span>: <span style="color:#e6db74">&#34;Identity &amp; Access Management&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_uid&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_uid&#34;</span>: <span style="color:#ae81ff">3002</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dst_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;domain&#34;</span>: <span style="color:#e6db74">&#34;ACME&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;hostname&#34;</span>: <span style="color:#e6db74">&#34;DESKTOP-ACME-042&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;DESKTOP-ACME-042&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_mfa&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_remote&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;logon_type&#34;</span>: <span style="color:#e6db74">&#34;Network&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;logon_type_id&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Unknown user name or bad password.&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;event_code&#34;</span>: <span style="color:#e6db74">&#34;4625&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_name&#34;</span>: <span style="color:#e6db74">&#34;Security&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_provider&#34;</span>: <span style="color:#e6db74">&#34;Microsoft-Windows-Security-Auditing&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;logged_time&#34;</span>: <span style="color:#ae81ff">1771401303412</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;original_time&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T07:55:03.412Z&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Windows Security Auditing&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Microsoft&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;profiles&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;host&#34;</span>
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;2847391&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;observables&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint.hostname&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;DESKTOP-ACME-042&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.port&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;49200&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;10.10.10.99&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.hostname&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;KALI-ATTACK-01&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;administrator&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;S-1-0-0&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;-&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;S-1-0-0&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;service&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;NTLM&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;session&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;is_remote&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;Medium&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity_id&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;src_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;hostname&#34;</span>: <span style="color:#e6db74">&#34;KALI-ATTACK-01&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;10.10.10.99&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">49200</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;Failure&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_code&#34;</span>: <span style="color:#e6db74">&#34;0xC000006D&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_detail&#34;</span>: <span style="color:#e6db74">&#34;INVALID_CREDENTIALS&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;time&#34;</span>: <span style="color:#ae81ff">1771401303412</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication: Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_uid&#34;</span>: <span style="color:#ae81ff">300201</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;domain&#34;</span>: <span style="color:#e6db74">&#34;ACME&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;administrator&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;S-1-0-0&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>What to Notice:</strong> The Windows hex status code <code>0xC000006D</code> is semantically translated to <code>&quot;Unknown user name or bad password&quot;</code> - not stored raw. A detection rule querying <code>status_detail CONTAINS &quot;bad password&quot; AND src_endpoint.ip == src_endpoint.ip</code> will now catch this Windows event and any other source reporting the same failure reason in their own proprietary codes, all translated to the same OCSF field.</p>
<hr>
<h3 id="example-3---palo-alto-ngfw-log4shell-threat-alert">Example 3 - Palo Alto NGFW: Log4Shell Threat Alert</h3>
<p>Palo Alto threat logs are particularly interesting - a lot of security-relevant information packed into a single comma-delimited syslog line. This is also a good test of the mapper&rsquo;s ability to handle positional CSV text.</p>
<p><strong>Raw Sample Log</strong> - save as <code>lab3-paloalto-threat.txt</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Feb 18 2026 09:12:47 PA-VM-5250 1,2026/02/18 09:12:47,012345678901,THREAT,vulnerability,2049,2026/02/18 09:12:47,203.0.113.88,10.0.2.45,203.0.113.88,10.0.2.45,Allow-Inbound,john.doe,vsys1,untrust,trust,ethernet1/1,ethernet1/2,Splunk-Forwarding,2026/02/18 09:12:47,54321,1,44821,443,0,0,0x80004000,tcp,alert,CVE-2021-44228,Log4Shell Remote Code Execution,critical,server-to-client,1234567,0x2000000000000000,United States,10.0.2.0-10.0.2.255,0,14,0,complete,,,,,,,1,0,0,0,corp-dmz-seg,0x0,CVE-2021-44228,Medium,client-to-server
</span></span></code></pre></div><p><strong>Step-by-Step Instructions:</strong></p>
<p>Following the same steps as listed in the above sections, you will get below output.</p>
<center><img src="/images/aws-fleak-7.png" width="1300"/></center></br>
<p><strong>OCSF Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_name&#34;</span>: <span style="color:#e6db74">&#34;Create&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_name&#34;</span>: <span style="color:#e6db74">&#34;Findings&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_uid&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Detection Finding&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_uid&#34;</span>: <span style="color:#ae81ff">2004</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;confidence&#34;</span>: <span style="color:#e6db74">&#34;Medium&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;confidence_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;count&#34;</span>: <span style="color:#ae81ff">443</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;end_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;finding_info&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;created_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;desc&#34;</span>: <span style="color:#e6db74">&#34;vulnerability vulnerability detected: critical - Log4Shell Remote Code Execution (CVE: CVE-2021-44228)&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;first_seen_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;last_seen_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;modified_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Palo Alto Networks Firewall&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;PA-VM-5250&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Palo Alto Networks&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;Log4Shell Remote Code Execution&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;types&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;vulnerability&#34;</span>
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;012345678901&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_alert&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Log4Shell Remote Code Execution&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_name&#34;</span>: <span style="color:#e6db74">&#34;THREAT&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;logged_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;original_time&#34;</span>: <span style="color:#e6db74">&#34;Feb 18 2026 09:12:47&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Palo Alto Networks Firewall&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Palo Alto Networks&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;012345678901&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;observables&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.45&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.45&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;203.0.113.88&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;203.0.113.88&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">38</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;PA-VM-5250&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;resources[].uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;PA-VM-5250&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;raw_data&#34;</span>: <span style="color:#e6db74">&#34;Feb 18 2026 09:12:47 PA-VM-5250 1,2026/02/18 09:12:47,012345678901,THREAT,vulnerability,2049,2026/02/18 09:12:47,203.0.113.88,10.0.2.45,203.0.113.88,10.0.2.45,Allow-Inbound,john.doe,vsys1,untrust,trust,ethernet1/1,ethernet1/2,Splunk-Forwarding,2026/02/18 09:12:47,54321,1,44821,443,0,0,0x80004000,tcp,alert,CVE-2021-44228,Log4Shell Remote Code Execution,critical,server-to-client,1234567,0x2000000000000000,United States,10.0.2.0-10.0.2.255,0,14,0,complete,,,,,,,1,0,0,0,corp-dmz-seg,0x0,CVE-2021-44228,Medium,client-to-server&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;resources&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.45&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;Target&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;IP Address&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.45&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;203.0.113.88&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;Actor&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;IP Address&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;203.0.113.88&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;PA-VM-5250&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;Related&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;Security Device&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;PA-VM-5250&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;Medium&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity_id&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;start_time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_detail&#34;</span>: <span style="color:#e6db74">&#34;alert&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;time&#34;</span>: <span style="color:#ae81ff">1771405967000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_name&#34;</span>: <span style="color:#e6db74">&#34;Detection Finding: Create&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_uid&#34;</span>: <span style="color:#ae81ff">200401</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;unmapped&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;action_flags&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.0-10.0.2.255&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;application&#34;</span>: <span style="color:#e6db74">&#34;untrust&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;category&#34;</span>: <span style="color:#e6db74">&#34;server-to-client&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;cloud&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;config_version&#34;</span>: <span style="color:#e6db74">&#34;2049&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;content_type&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;content_version&#34;</span>: <span style="color:#e6db74">&#34;client-to-server&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;destination_country&#34;</span>: <span style="color:#e6db74">&#34;14&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;destination_port&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;destination_user&#34;</span>: <span style="color:#e6db74">&#34;vsys1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;destination_zone&#34;</span>: <span style="color:#e6db74">&#34;ethernet1/2&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;device_name&#34;</span>: <span style="color:#e6db74">&#34;CVE-2021-44228&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;direction&#34;</span>: <span style="color:#e6db74">&#34;0x2000000000000000&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;file_digest&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;file_type&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;future_use&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;inbound_interface&#34;</span>: <span style="color:#e6db74">&#34;Splunk-Forwarding&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_action&#34;</span>: <span style="color:#e6db74">&#34;54321&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;nat_destination_ip&#34;</span>: <span style="color:#e6db74">&#34;10.0.2.45&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;nat_destination_port&#34;</span>: <span style="color:#e6db74">&#34;tcp&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;nat_source_ip&#34;</span>: <span style="color:#e6db74">&#34;203.0.113.88&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;nat_source_port&#34;</span>: <span style="color:#e6db74">&#34;0x80004000&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;outbound_interface&#34;</span>: <span style="color:#e6db74">&#34;2026/02/18 09:12:47&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;pcap_id&#34;</span>: <span style="color:#e6db74">&#34;complete&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;recipient&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;referer&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;report_id&#34;</span>: <span style="color:#e6db74">&#34;corp-dmz-seg&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;rule_name&#34;</span>: <span style="color:#e6db74">&#34;Allow-Inbound&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;sender&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;sequence_number&#34;</span>: <span style="color:#e6db74">&#34;United States&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;session_id&#34;</span>: <span style="color:#e6db74">&#34;44821&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;1234567&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;source_country&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;source_port&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;source_user&#34;</span>: <span style="color:#e6db74">&#34;john.doe&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;source_zone&#34;</span>: <span style="color:#e6db74">&#34;ethernet1/1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;subject&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;time_logged&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;url_index&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user_agent&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;virtual_system&#34;</span>: <span style="color:#e6db74">&#34;trust&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;virtual_system_name&#34;</span>: <span style="color:#e6db74">&#34;0x0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;x_forwarded_for&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>What to Notice:</strong> This is where the AI earns its keep on unstructured text. Extracting CVE identifiers, mapping positional CSV columns to named OCSF fields, and translating Palo Alto&rsquo;s internal severity levels to OCSF severity enums - all without a single regex. Check carefully whether the AI correctly identifies column positions; Palo Alto has slightly different column orderings across firmware versions, which is a real production edge case.</p>
<hr>
<h3 id="example-4---zeek-bro-network-sensor-connlog-with-c2-pattern">Example 4 - Zeek (Bro) Network Sensor: conn.log with C2 Pattern</h3>
<p>Zeek is widely used for network traffic analysis. Its <code>conn.log</code> is a tab-separated format with a metadata header. This tests the mapper&rsquo;s ability to handle TSV with Zeek-specific state abbreviations.</p>
<p><strong>Raw Sample Log</strong> - save as <code>lab4-zeek-conn.log</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>#separator \x09
</span></span><span style="display:flex;"><span>#set_separator	,
</span></span><span style="display:flex;"><span>#empty_field	(empty)
</span></span><span style="display:flex;"><span>#unset_field	-
</span></span><span style="display:flex;"><span>#path	conn
</span></span><span style="display:flex;"><span>#fields	ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	proto	service	duration	orig_bytes	resp_bytes	conn_state	local_orig	missed_bytes	history
</span></span><span style="display:flex;"><span>#types	time	string	addr	port	addr	port	enum	string	interval	count	count	string	bool	count	string
</span></span><span style="display:flex;"><span>1739870100.123456	CRnC0F3KBYZ1234567	10.10.10.5	54876	185.220.101.47	4444	tcp	-	0.048271	512	0	S1	T	0	ShADfFr
</span></span><span style="display:flex;"><span>1739870101.234567	Dab4F1MCKZQ9876543	10.10.10.5	54877	185.220.101.47	4444	tcp	-	120.341200	204800	51200	SF	T	0	ShADadFfR
</span></span><span style="display:flex;"><span>1739870102.345678	E7hG2N4PLXR1122334	192.168.1.200	12345	10.0.0.53	53	udp	dns	0.001234	72	188	SF	F	0	Dd
</span></span></code></pre></div><p><strong>Step-by-Step Instructions:</strong></p>
<p>Following the same steps as listed in the above sections, you will get below output.</p>
<center><img src="/images/aws-fleak-7.png" width="1300"/></center></br>
<p><strong>OCSF Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_name&#34;</span>: <span style="color:#e6db74">&#34;Open&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;app_name&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_name&#34;</span>: <span style="color:#e6db74">&#34;Network Activity&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_uid&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Network Activity&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_uid&#34;</span>: <span style="color:#ae81ff">4001</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;connection_info&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;direction&#34;</span>: <span style="color:#e6db74">&#34;Outbound&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;direction_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;flag_history&#34;</span>: <span style="color:#e6db74">&#34;ShADfFr&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;protocol_name&#34;</span>: <span style="color:#e6db74">&#34;tcp&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;protocol_num&#34;</span>: <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;CRnC0F3KBYZ1234567&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dst_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;185.220.101.47&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;duration&#34;</span>: <span style="color:#ae81ff">48</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_src_dst_assignment_known&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;log_name&#34;</span>: <span style="color:#e6db74">&#34;conn&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;original_time&#34;</span>: <span style="color:#e6db74">&#34;1739870100.123456&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Zeek&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Zeek&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;CRnC0F3KBYZ1234567&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;observables&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint.port&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;4444&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;dst_endpoint.ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;185.220.101.47&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.port&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;54876&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;10.10.10.5&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;Informational&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;src_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;10.10.10.5&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">54876</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;Failure&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_detail&#34;</span>: <span style="color:#e6db74">&#34;S1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;time&#34;</span>: <span style="color:#ae81ff">1739870100123</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;traffic&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;bytes&#34;</span>: <span style="color:#ae81ff">512</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;bytes_in&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;bytes_missed&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;bytes_out&#34;</span>: <span style="color:#ae81ff">512</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_name&#34;</span>: <span style="color:#e6db74">&#34;Network Activity: Open&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_uid&#34;</span>: <span style="color:#ae81ff">400101</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>What to Notice:</strong> Port 4444 is a canonical Metasploit listener port. The second row shows 120 seconds of duration with 200KB outbound transfer - characteristic of an active command-and-control session. Once normalised to OCSF, a single detection query <code>dst_endpoint.port == 4444</code> catches this regardless of whether the sensor is Zeek, Suricata, or a commercial NDR platform.</p>
<hr>
<h3 id="example-5---okta-system-log-impossible-travel">Example 5 - Okta System Log: Impossible Travel</h3>
<p>This lab demonstrates a classic security signal - a user authenticating from two geographically distant locations within an impossibly short time window.</p>
<p><strong>Raw Sample Log</strong> - save both events as <code>lab6-okta-impossible-travel.json</code> (use the first event to generate the mapping, then test with both):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;actor&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;00u1abc2DEF3GHI456&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;alternateId&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;displayName&#34;</span>: <span style="color:#e6db74">&#34;Priya Sharma&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;client&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;ipAddress&#34;</span>: <span style="color:#e6db74">&#34;103.21.244.0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;geographicalContext&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;country&#34;</span>: <span style="color:#e6db74">&#34;India&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;state&#34;</span>: <span style="color:#e6db74">&#34;Karnataka&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;city&#34;</span>: <span style="color:#e6db74">&#34;Bengaluru&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;userAgent&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rawUserAgent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;os&#34;</span>: <span style="color:#e6db74">&#34;iOS&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;browser&#34;</span>: <span style="color:#e6db74">&#34;SAFARI&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;eventType&#34;</span>: <span style="color:#e6db74">&#34;user.session.start&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;outcome&#34;</span>: { <span style="color:#f92672">&#34;result&#34;</span>: <span style="color:#e6db74">&#34;SUCCESS&#34;</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;published&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T08:00:00.000Z&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;securityContext&#34;</span>: { <span style="color:#f92672">&#34;isProxy&#34;</span>: <span style="color:#66d9ef">false</span>, <span style="color:#f92672">&#34;isTor&#34;</span>: <span style="color:#66d9ef">false</span> },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uuid&#34;</span>: <span style="color:#e6db74">&#34;f1e2d3c4-b5a6-7890-fedc-ba0987654321&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;authenticationContext&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;externalSessionId&#34;</span>: <span style="color:#e6db74">&#34;idx_session_abc123&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;interface&#34;</span>: <span style="color:#e6db74">&#34;SAML2&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;credentialType&#34;</span>: <span style="color:#e6db74">&#34;PASSWORD_IWA&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><strong>Step-by-Step Instructions:</strong></p>
<p>Following the same steps as listed in the above sections, you will get below output.</p>
<p><strong>OCSF Output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;activity_name&#34;</span>: <span style="color:#e6db74">&#34;Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;actor&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;session&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;created_time&#34;</span>: <span style="color:#ae81ff">1771401600000</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;idx_session_abc123&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;display_name&#34;</span>: <span style="color:#e6db74">&#34;Priya Sharma&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;email_addr&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;00u1abc2DEF3GHI456&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol&#34;</span>: <span style="color:#e6db74">&#34;SAML&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;auth_protocol_id&#34;</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_name&#34;</span>: <span style="color:#e6db74">&#34;Identity &amp; Access Management&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;category_uid&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;class_uid&#34;</span>: <span style="color:#ae81ff">3002</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;http_request&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;user_agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_mfa&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;is_remote&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;logon_type&#34;</span>: <span style="color:#e6db74">&#34;Network&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;logon_type_id&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;User session started&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;metadata&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;logged_time&#34;</span>: <span style="color:#ae81ff">1771401600000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;original_time&#34;</span>: <span style="color:#e6db74">&#34;2026-02-18T08:00:00.000Z&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;product&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Okta&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;vendor_name&#34;</span>: <span style="color:#e6db74">&#34;Okta&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;f1e2d3c4-b5a6-7890-fedc-ba0987654321&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;observables&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.ip&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;103.21.244.0&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.location&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;src_endpoint.location.country&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">14</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;India&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;00u1abc2DEF3GHI456&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;user.email_addr&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;http_request.user_agent&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">16</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.uid&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;00u1abc2DEF3GHI456&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;actor.user.email_addr&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;service&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;SAML2&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;idx_session_abc123&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;session&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;created_time&#34;</span>: <span style="color:#ae81ff">1771401600000</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;is_remote&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;issuer&#34;</span>: <span style="color:#e6db74">&#34;SAML2&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;idx_session_abc123&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uuid&#34;</span>: <span style="color:#e6db74">&#34;f1e2d3c4-b5a6-7890-fedc-ba0987654321&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;Informational&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;severity_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;src_endpoint&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;103.21.244.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;location&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;city&#34;</span>: <span style="color:#e6db74">&#34;Bengaluru&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;country&#34;</span>: <span style="color:#e6db74">&#34;India&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;region&#34;</span>: <span style="color:#e6db74">&#34;Karnataka&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;os&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;iOS&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;iOS&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">301</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;Mobile&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;Success&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_code&#34;</span>: <span style="color:#e6db74">&#34;SUCCESS&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_detail&#34;</span>: <span style="color:#e6db74">&#34;Authentication successful&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;status_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;time&#34;</span>: <span style="color:#ae81ff">1771401600000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_name&#34;</span>: <span style="color:#e6db74">&#34;Authentication: Logon&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;type_uid&#34;</span>: <span style="color:#ae81ff">300201</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;unmapped&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;securityContext&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;isProxy&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;isTor&#34;</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;user&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;display_name&#34;</span>: <span style="color:#e6db74">&#34;Priya Sharma&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;email_addr&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;full_name&#34;</span>: <span style="color:#e6db74">&#34;Priya Sharma&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;priya.sharma@acme.com&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;User&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;uid&#34;</span>: <span style="color:#e6db74">&#34;00u1abc2DEF3GHI456&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="07---zephflow-the-open-source-execution-engine">07 - ZephFlow: The Open-Source Execution Engine</h2>
<blockquote>
<p><strong>For Security Operations:</strong> ZephFlow processes your logs at runtime using the configurations you built in the Mapper. It is open-source, lightweight, and designed to run anywhere - your on-prem servers, your cloud VPC, edge infrastructure, or alongside existing Kafka or Kinesis streams.</p>
</blockquote>
<p>The diagram below shows a production-grade ZephFlow deployment processing all six of our lab log sources simultaneously, routing normalised OCSF events to different downstream platforms:</p>
<center><img src="/images/fleak5.png" width="1050"/></center></br>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Simplified ZephFlow workflow definition - referencing Lab mapping configs</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">sources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">kinesis</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stream</span>: <span style="color:#ae81ff">raw-security-logs</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">region</span>: <span style="color:#ae81ff">ap-south-1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">processors</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ocsf_transform</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">config_file</span>: <span style="color:#ae81ff">./mappings/cloudtrail-config.json   </span> <span style="color:#75715e"># exported from Lab 1</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ocsf_transform</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">config_file</span>: <span style="color:#ae81ff">./mappings/windows-4625-config.json </span> <span style="color:#75715e"># exported from Lab 2</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">type</span>: <span style="color:#ae81ff">route</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Routes can match on any OCSF field: class, action, severity, etc.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>              - <span style="color:#f92672">match</span>: <span style="color:#e6db74">&#34;severity &gt;= &#39;Critical&#39;&#34;</span>      <span style="color:#75715e"># Critical findings → threat intel enrichment</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">destination</span>: <span style="color:#ae81ff">findings-sink</span>
</span></span><span style="display:flex;"><span>              - <span style="color:#f92672">match</span>: <span style="color:#e6db74">&#34;action == &#39;Refuse&#39;&#34;</span>           <span style="color:#75715e"># Refused/blocked traffic → Security Lake</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">destination</span>: <span style="color:#ae81ff">network-events-sink</span>
</span></span><span style="display:flex;"><span>              - <span style="color:#f92672">match</span>: <span style="color:#e6db74">&#34;class_uid == 3002&#34;</span>            <span style="color:#75715e"># Authentication events → SIEM</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">destination</span>: <span style="color:#ae81ff">auth-events-sink</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">sinks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">auth-events-sink</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">splunk</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">index</span>: <span style="color:#ae81ff">ocsf_authentication</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">network-events-sink</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">s3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">bucket</span>: <span style="color:#ae81ff">security-data-lake</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">prefix</span>: <span style="color:#ae81ff">ocsf/network/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">format</span>: <span style="color:#ae81ff">parquet</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">findings-sink</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">kinesis</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stream</span>: <span style="color:#ae81ff">threat-intel-enrichment-queue</span>
</span></span></code></pre></div><hr>
<h2 id="08---the-honest-verdict-360-degree-evaluation">08 - The Honest Verdict: 360-Degree Evaluation</h2>
<h3 id="what-works-well">What Works Well</h3>
<p><strong>AI classification accuracy for major log sources.</strong> JSON log Examples validate this directly. For well-known log formats, majority of the time AI correctly identified not just field mappings but the semantic intent of events, including activity IDs and status codes.</p>
<p><strong>Handling of unstructured syslog text.</strong> Non-json log files (unstructured) test this directly. The mapper handles both structured JSON and non-structured JSON very well without taking any parser input from me.</p>
<p><strong>Exportable, versionable configuration files.</strong> Human-readable output that fits naturally into Git workflows, code review, and change management.</p>
<h3 id="what-needs-work">What Needs Work</h3>
<p><strong>Accuracy degradation on obscure or custom log formats.</strong> Lab 5 (custom app log) demonstrates this directly - <code>anomaly_flags</code>, <code>transfer_amount_usd</code>, and business-context fields require manual decisions. On truly custom formats, expect 30–60 minutes in the Visual Editor per mapping.</p>
<p><strong>Schema drift handling in production is not fully demonstrated.</strong> When AWS adds a new CloudTrail field, what exactly happens? Silent drop? Alert? Extension storage? This is critical for production stability.</p>
<p><strong>No native MITRE ATT&amp;CK enrichment layer.</strong> Lab 3 contains <code>CVE-2021-44228</code> (Log4Shell), which maps directly to ATT&amp;CK <code>T1190</code>. The mapper produces an OCSF finding but does not tag the ATT&amp;CK technique. That enrichment step must happen downstream.</p>
<h3 id="feature-comparison-against-alternatives">Feature Comparison Against Alternatives</h3>
<table>
  <thead>
      <tr>
          <th>Capability</th>
          <th>Fleak OCSF Mapper</th>
          <th>Manual Engineering</th>
          <th>SIEM Native Parser</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>AI-assisted field mapping</td>
          <td>✅ YES</td>
          <td>❌ NO</td>
          <td>❌ NO</td>
      </tr>
      <tr>
          <td>OCSF-native output</td>
          <td>✅ YES</td>
          <td>✅ YES</td>
          <td>❌ NO</td>
      </tr>
      <tr>
          <td>Portable config files (GitOps ready)</td>
          <td>✅ YES</td>
          <td>✅ YES</td>
          <td>❌ NO</td>
      </tr>
      <tr>
          <td>Free to use for authoring</td>
          <td>✅ YES</td>
          <td>✅ (just time)</td>
          <td>⚠️ Bundled</td>
      </tr>
      <tr>
          <td>Handles unstructured syslog text</td>
          <td>✅ YES</td>
          <td>✅ YES</td>
          <td>⚠️ VARIES</td>
      </tr>
      <tr>
          <td>Real-time testing in UI</td>
          <td>✅ YES</td>
          <td>❌ NO</td>
          <td>⚠️ LIMITED</td>
      </tr>
      <tr>
          <td>Confidence scoring on AI suggestions</td>
          <td>❌ NOT YET</td>
          <td>❌ N/A</td>
          <td>❌ NO</td>
      </tr>
      <tr>
          <td>MITRE ATT&amp;CK tagging at ingestion</td>
          <td>❌ NOT YET</td>
          <td>⚠️ MANUAL</td>
          <td>❌ NO</td>
      </tr>
      <tr>
          <td>Air-gapped / on-prem deployment</td>
          <td>✅ YES (ZephFlow)</td>
          <td>✅ YES</td>
          <td>✅ YES</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="the-broader-context-why-this-matters-for-ai-soc">The Broader Context: Why This Matters for AI SOC</h2>
<p>There is a direct line between the work Fleak is doing and the AI SOC evolution that the industry is navigating. The first wave of AI SOC platforms failed partly because they were trying to build intelligent analysis on top of fragmented, unnormalised data. The result was expensive queries, inconsistent results, and analysts who ended up going directly to JSON logs anyway because the AI summaries could not be trusted.</p>
<p>The diagram below illustrates exactly what the data layer looks like before and after OCSF normalisation - and why this matters so much for AI model accuracy:</p>
<center><img src="/images/fleak7.png" width="850"/></center></br>
<p>The majority failure rate of AI agent projects within 30 days is not primarily a model quality problem. It is a data quality problem. Models trained on or prompted with normalised, semantically consistent data outperform models dealing with fragmented vendor dialects - by a wide margin.</p>
<hr>
<h2 id="final-thoughts">Final Thoughts</h2>
<p>The Fleak OCSF Log Mapper is a genuinely useful, honestly-priced tool that tackles a real and significant problem in security data engineering. The AI mapping quality is impressive for major log sources - the six hands-on labs in this post validated that directly. The architecture - separating authoring from execution, producing portable config files - is sound and production-friendly. The gaps (confidence scoring, ATT&amp;CK enrichment, obscure format accuracy, enterprise runtime maturity) are real but not disqualifying.</p>
<p>The five labs give you everything you need to evaluate this tool against your actual environment. Load your own versions of these log samples. Compare the AI&rsquo;s output to what you know the correct OCSF mapping should be. That direct comparison - more than any benchmark or analyst report - will tell you whether this tool belongs in your security data engineering stack.</p>
<hr>
<p><strong>Links:</strong></p>
<ul>
<li>Tool: <a href="https://app.ocsf.fleak.ai/">app.ocsf.fleak.ai</a></li>
<li>Docs: <a href="https://docs.fleak.ai/ocsfmapper/intro">docs.fleak.ai/ocsfmapper/intro</a></li>
<li>Runtime: <a href="https://github.com/fleaktech/zephflow-core">github.com/fleaktech/zephflow-core</a></li>
<li>OCSF Schema Browser: <a href="https://schema.ocsf.io">schema.ocsf.io</a></li>
<li>Diagram Renderer: <a href="https://dreampuf.github.io/GraphvizOnline/">dreampuf.github.io/GraphvizOnline</a></li>
</ul>
<hr>
<p><em>Disclosure &amp; Methodology: This review was conducted using the publicly available free version of the Fleak OCSF Mapper at app.ocsf.fleak.ai. No commercial relationship with Fleak exists. Sample logs in the hands-on labs are synthetic but constructed to be structurally accurate representations of real vendor log formats. OCSF output accuracy was validated against the official OCSF schema at schema.ocsf.io. ZephFlow was evaluated at the documentation and architecture level; production load testing was not conducted. All opinions expressed are independent.</em></p>

      </div>
    </section>

    
    
  </article>
</main>











</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>


<script>hljs.highlightAll();</script>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="/js/custom.js"></script>
</body>

</html>


